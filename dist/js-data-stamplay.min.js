/*!
* js-data-http
* @version 2.2.2 - Homepage <https://github.com/js-data/js-data-http>
* @copyright (c) 2014-2016 js-data-http project authors
* @license MIT <https://github.com/js-data/js-data-http/blob/master/LICENSE>
*
* @overview HTTP adapter for js-data.
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("js-data")):"function"==typeof define&&define.amd?define(["js-data"],t):"object"==typeof exports?exports.DSStamplayAdapter=t(require("js-data")):e.DSStamplayAdapter=t(e.Window)}(this,function(e){return function(e){function t(a){if(r[a])return r[a].exports;var i=r[a]={exports:{},id:a,loaded:!1};return e[a].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){return void 0===e}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),u=r(1),l=r(2),c=u.DSUtils,p=c.deepMixIn,m=c.removeCircular,h=c.copy,f=c.makePath,d=c.isString,y=c.isNumber,S=function(){function e(){i(this,e)}return o(e,[{key:"queryTransform",value:function(e,t){return t}},{key:"deserialize",value:function(e,t){return t.data.data}},{key:"serialize",value:function(e,t){return t}}]),e}(),g=S.prototype;g.appid="",g.forceTrailingSlash="",g.httpConfig={},g.verbsUseBasePath=!1;var v=function(){function e(t){i(this,e),t||(t={}),this.defaults=new S,p(this.defaults,t),this.stamplay=l.init(t.appid)}return o(e,[{key:"getEndpoint",value:function(e,t,r){r||(r={}),r.params=n(r.params)?{}:r.params;var i=r.hasOwnProperty("endpoint")?r.endpoint:e.endpoint,s=e.parents||(e.parent?a({},e.parent,{key:e.parentKey,field:e.parentField}):{});return c.forOwn(s,function(a,n){var s=this,o=void 0,u=a.key,l=a.field,p=e.getResource(n),m=r.params[u];m!==!1&&u&&p?(delete r.params[u],c._sn(t)?o=e.get(t):c._o(t)&&(o=t),o&&(m=m||o[u]||(o[l]?o[l][p.idAttribute]:null)),m&&!function(){delete r.endpoint;var e={};c.forOwn(r,function(t,r){e[r]=t}),i=c.makePath(s.getEndpoint(p,m,c._(p,e)),m,i)}()):m===!1&&delete r.params[u]},this),i}},{key:"getPath",value:function(e,t,r,a){var i=this;if(a||(a={}),d(a.urlPath))return f.apply(c,[a.basePath||i.defaults.basePath||t.basePath,a.urlPath]);var n=[a.basePath||i.defaults.basePath||t.basePath,this.getEndpoint(t,d(r)||y(r)||"create"===e?r:null,a)];return"find"!==e&&"update"!==e&&"destroy"!==e||n.push(r),f.apply(c,n)}},{key:"HTTP",value:function(e){function t(t,i){if(t=t||{},t instanceof Error)return r.defaults.error("FAILED: "+(t.message||"Unknown Error"),t),c.Promise.reject(t);if("object"===("undefined"==typeof t?"undefined":s(t))){var n=a.toUTCString()+" - "+e.method+" "+e.url+" - "+t.status+" "+((new Date).getTime()-a.getTime())+"ms";return t.status>=200&&t.status<300&&!i?(r.defaults.log&&r.defaults.log(n,t),t):(r.defaults.error&&r.defaults.error("FAILED: "+n,t),c.Promise.reject(t))}return r.defaults.error("FAILED",t),c.Promise.reject(t)}var r=this,a=new Date,i=e.data,o=e.cache,u=e.timeout;e=h(e,null,null,null,["data","cache","timeout"]),e=p(e,r.defaults.httpConfig),e.data=i,e.cache=o,e.timeout=u,"verbsUseBasePath"in e||(e.verbsUseBasePath=r.defaults.verbsUseBasePath),!e.urlOverride&&e.verbsUseBasePath&&(e.url=f(e.basePath||r.defaults.basePath,e.url)),r.defaults.forceTrailingSlash&&"/"!==e.url[e.url.length-1]&&!e.urlOverride&&(e.url+="/"),"object"===s(e.data)&&(e.data=m(e.data)),e.method=e.method.toUpperCase();var l=n(e.suffix)?r.defaults.suffix:e.suffix;if(l&&e.url.substr(e.url.length-l.length)!==l&&!e.urlOverride&&(e.url+=l),!this.http)throw new Error("You have not configured this adapter with an http library!");return this.http(e).then(t,function(e){return t(e,!0)})}},{key:"GET",value:function(e,t){return t=t||{},t.method=t.method||"get",t.urlOverride=!!t.url,t.url=t.url||e,this.HTTP(t)}},{key:"POST",value:function(e,t,r){return r=r||{},r.method=r.method||"post",r.urlOverride=!!r.url,r.url=r.url||e,r.data=r.data||t,this.HTTP(r)}},{key:"PUT",value:function(e,t,r){return r=r||{},r.method=r.method||"put",r.urlOverride=!!r.url,r.url=r.url||e,r.data=r.data||t,this.HTTP(r)}},{key:"DEL",value:function(e,t){return t=t||{},t.method=t.method||"delete",t.urlOverride=!!t.url,t.url=t.url||e,this.HTTP(t)}},{key:"find",value:function(e,t,r){var a=this;return r||(r={}),r.suffix=n(r.suffix)?e.suffix:r.suffix,r.params=n(r.params)?{}:h(r.params),r.params=a.defaults.queryTransform(e,r.params),a.GET(a.getPath("find",e,t,r),r).then(function(t){var i=(r.deserialize?r.deserialize:a.defaults.deserialize)(e,t);return i?i:c.Promise.reject(new Error("Not Found!"))})}},{key:"findAll",value:function(e,t,r){var a=this;return r||(r={}),r.suffix=n(r.suffix)?e.suffix:r.suffix,r.params=n(r.params)?{}:h(r.params),t&&(t=a.defaults.queryTransform(e,t),p(r.params,t)),a.GET(a.getPath("findAll",e,t,r),r).then(function(t){return(r.deserialize?r.deserialize:a.defaults.deserialize)(e,t)})}},{key:"create",value:function(e,t,r){var a=this;return r||(r={}),r.suffix=n(r.suffix)?e.suffix:r.suffix,r.params=n(r.params)?{}:h(r.params),r.params=a.defaults.queryTransform(e,r.params),a.POST(a.getPath("create",e,t,r),r.serialize?r.serialize(e,t):a.defaults.serialize(e,t),r).then(function(t){return(r.deserialize?r.deserialize:a.defaults.deserialize)(e,t)})}},{key:"update",value:function(e,t,r,a){var i=this;return a||(a={}),a.suffix=n(a.suffix)?e.suffix:a.suffix,a.params=n(a.params)?{}:h(a.params),a.params=i.defaults.queryTransform(e,a.params),i.PUT(i.getPath("update",e,t,a),a.serialize?a.serialize(e,r):i.defaults.serialize(e,r),a).then(function(t){return(a.deserialize?a.deserialize:i.defaults.deserialize)(e,t)})}},{key:"updateAll",value:function(e,t,r,a){var i=this;return a||(a={}),a.suffix=n(a.suffix)?e.suffix:a.suffix,a.params=n(a.params)?{}:h(a.params),r&&(r=i.defaults.queryTransform(e,r),p(a.params,r)),this.PUT(i.getPath("updateAll",e,t,a),a.serialize?a.serialize(e,t):i.defaults.serialize(e,t),a).then(function(t){return(a.deserialize?a.deserialize:i.defaults.deserialize)(e,t)})}},{key:"destroy",value:function(e,t,r){var a=this;return r||(r={}),r.suffix=n(r.suffix)?e.suffix:r.suffix,r.params=n(r.params)?{}:h(r.params),r.params=a.defaults.queryTransform(e,r.params),a.DEL(a.getPath("destroy",e,t,r),r).then(function(t){return(r.deserialize?r.deserialize:a.defaults.deserialize)(e,t)})}},{key:"destroyAll",value:function(e,t,r){var a=this;return r||(r={}),r.suffix=n(r.suffix)?e.suffix:r.suffix,r.params=n(r.params)?{}:h(r.params),t&&(t=a.defaults.queryTransform(e,t),p(r.params,t)),this.DEL(a.getPath("destroyAll",e,t,r),r).then(function(t){return(r.deserialize?r.deserialize:a.defaults.deserialize)(e,t)})}}]),e}();v.version={full:"<%= pkg.version %>",major:parseInt("<%= major %>",10),minor:parseInt("<%= minor %>",10),patch:parseInt("<%= patch %>",10),alpha:"<%= alpha %>",beta:"<%= beta %>"},e.exports=v},function(t,r){t.exports=e},function(e,t){!function(e){"use strict";function t(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(e.location.search)||[,""])[1].replace(/\+/g,"%20"))||null}e.Stamplay=e.Stamplay||{},e.Stamplay.VERSION="v1",e.Stamplay.APPID="",e.Stamplay.BASEURL="",e.Stamplay.OPTIONS={},e.localStorage&&store.enabled&&(e.Stamplay.USESTORAGE=!0),t("jwt")&&e.Stamplay.USESTORAGE&&store.set(e.location.origin+"-jwt",t("jwt")),e.Stamplay.init=function(t,r){e.Stamplay.BASEURL="https://"+t+".stamplayapp.com",e.Stamplay.APPID=t,e.Stamplay.OPTIONS=r||{}},e.Stamplay.isString=function(e){return"string"==typeof e||!!e&&"object"==typeof e&&"[object String]"===Object.prototype.toString.call(e)},e.Stamplay.isNumber=function(e){return"number"==typeof value||!isNaN(parseFloat(e))&&isFinite(e)},e.Stamplay.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)},e.Stamplay.extend=function(e,t){var r,a,i=Object.keys(t),n=i.length;for(r=0;n>r;++r)a=i[r],e[a]=t[a];return e}}(this),function(e){"use strict";function t(t,r,a){if(Object.keys(a.headers||{}).forEach(function(e){r.setRequestHeader(e,a.headers[e])}),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json, text/plain"),r.setRequestHeader("stamplay-app",t),e.Stamplay.USESTORAGE){var i=store.get(e.location.origin+"-jwt");i&&(s(i)?r.setRequestHeader("x-stamplay-jwt",i):store.remove(e.location.origin+"-jwt"))}}function r(t){var r=t.getResponseHeader("x-stamplay-jwt");if(r){var i=a(r);e.Stamplay.USESTORAGE&&store.set(e.location.origin+"-jwt",r)}return i}function a(e){var t={},r={},a="";try{var n=e.split(".");t=JSON.parse(i(n[0]||"{}")),r=JSON.parse(i(n[1]||"{}")),a=n[2]}catch(e){}return{header:t,claims:r,signature:a}}function i(e){return"undefined"!=typeof atob?atob(e):n(e)}function n(e){var t,r,a,i,n={},s=0,o=0,u="",l=String.fromCharCode,c=e.length,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0;64>t;t++)n[p.charAt(t)]=t;for(a=0;c>a;a++)for(r=n[e.charAt(a)],s=(s<<6)+r,o+=6;o>=8;)((i=s>>>(o-=8)&255)||c-2>a)&&(u+=l(i));return u}function s(e){var t,r,i=a(e).claims,n=Math.floor((new Date).getTime()/1e3);if("object"==typeof i){if(i.hasOwnProperty("iat")){t=i.iat;var s=3e4,o=new Date(1e3*t),u=new Date(o-s);t=u.getTime()/1e3}r=i.hasOwnProperty("exp")?i.exp:t+86400}return n&&t&&r&&n>=t&&r>=n}var o=function(e){for(var t=Object.keys(e.thisParams),r=0;r<t.length;r++){var a=r>0?"&":"?",i=t[r];e.url=e.url+a+i+"="+e.thisParams[i]}};e.Stamplay.makeAPromise=function(a,i){a.thisParams&&o(a);var n=e.Stamplay.APPID;""!=e.Stamplay.APPID?a.url=e.Stamplay.BASEURL+a.url:(n=location.host,n=n.replace(/^www\./,""),n=n.replace(/:[0-9]*$/g,""));var s=new XMLHttpRequest;s.open(a.method||"GET",a.url,a.async||!0),t(n,s,a);var u=Q.defer();return s.onreadystatechange=function(){4==s.readyState&&(-1===[200,304].indexOf(s.status)?u.reject({code:s.status,message:s.responseText}):(r(s),u.resolve(JSON.parse(s.responseText))),u.promise.nodeify(i))},s.send(JSON.stringify(a.data)||void 0),u.promise}}(this),function(e){"use strict";function t(t,r){var a=function(e,t){switch(e){case"cobject":delete t.__v,delete t.cobjectId,delete t.actions,delete t.appId,delete t.id;break;case"user":delete t._id,delete t.id,delete t.__v}},i=function(t,r,a,i,n,s){var o={method:a,url:"/api/"+t+"/"+e.Stamplay.VERSION+"/"+r};return i&&(o.url=o.url+"/"+i),n&&"GET"!=a&&(o.data=n),"GET"==a&&(o.thisParams=n),e.Stamplay.makeAPromise(o,s)};return{brickId:t,resourceId:r,get:function(e,t){return i(this.brickId,this.resourceId,"GET",!1,e,t)},getById:function(e,t,r){return i(this.brickId,this.resourceId,"GET",e,t,r)},save:function(e,t){return i(this.brickId,this.resourceId,"POST",!1,e,t)},patch:function(e,t,r){return a(this.brickId,t),i(this.brickId,this.resourceId,"PATCH",e,t,r)},update:function(e,t,r){return a(this.brickId,t),i(this.brickId,this.resourceId,"PUT",e,t,r)},remove:function(e,t){return i(this.brickId,this.resourceId,"DELETE",e,!1,t)}}}e.Stamplay.BaseComponent=t}(this),function(e){"use strict";function t(){this.redirect=function(t){e.location.href=t},this.validateEmail=function(t,r){return e.Stamplay.makeAPromise({method:"POST",data:{email:t},url:"/api/auth/"+e.Stamplay.VERSION+"/validate/email"},r)}}var r=new t;e.Stamplay.Support=r}(this),function(e){"use strict";function t(e,t,r,a,i,n){var s={_geolocation:{}};return s._geolocation[e]={},s._geolocation[e][t]={type:r,coordinates:a},i&&(s._geolocation[e].$maxDistance=i),n&&(s._geolocation[e].$minDistance=n),s}function r(e,t){var r={_geolocation:{$geoWithin:{}}};return r._geolocation.$geoWithin[e]=t,r}function a(a,i){return{model:a,instance:i,paginationQuery:"",sortQuery:"",selectionQuery:"",populateQuery:"",populateOwnerQuery:"",whereQuery:[],executable:"",or:function(){var e={$or:[]},t=arguments;arguments[0]instanceof Array&&(t=arguments[0]);for(var r=0;r<t.length;r++){if(!t[r].whereQuery)throw new Error("Please Or function take only Query object");e.$or.push(t[r].whereQuery[0])}return this.whereQuery.push(e),this},pagination:function(e,t){return this.paginationQuery="&page="+e+"&per_page="+t,this},between:function(e,t,r){var a={};return a[e]={$gte:t,$lte:r},this.whereQuery.push(a),this},greaterThan:function(e,t){var r={};return r[e]={$gt:t},this.whereQuery.push(r),this},greaterThanOrEqual:function(e,t){var r={};return r[e]={$gte:t},this.whereQuery.push(r),this},lessThan:function(e,t){var r={};return r[e]={$lt:t},this.whereQuery.push(r),this},lessThanOrEqual:function(e,t){var r={};return r[e]={$lte:t},this.whereQuery.push(r),this},equalTo:function(e,t){var r={};return r[e]=t,this.whereQuery.push(r),this},notEqualTo:function(e,t){var r={};return r[e]={$ne:t},this.whereQuery.push(r),this},sortAscending:function(e){return this.sortQuery="&sort="+e,this},sortDescending:function(e){return this.sortQuery="&sort=-"+e,this},exists:function(e){var t={};return t[e]={$exists:!0},this.whereQuery.push(t),this},notExists:function(e){var t={};return t[e]={$exists:!1},this.whereQuery.push(t),this},regex:function(e,t,r){var a={};return a[e]={$regex:t,$options:r},this.whereQuery.push(a),this},populate:function(){return this.populateQuery="&populate=true",this},populateOwner:function(){return this.populateOwnerQuery="&populate_owner=true",this},select:function(){return this.selectionQuery="&select="+Array.prototype.slice.call(arguments).join(", ").replace(" ",""),this},near:function(e,r,a,i){var n=t("$near","$geometry",e,r,a,i);return this.whereQuery.push(n),this},nearSphere:function(e,r,a,i){var n=t("$nearSphere","$geometry",e,r,a,i);return this.whereQuery.push(n),this},geoIntersects:function(e,r){var a=t("$geoIntersects","$geometry",e,r);return this.whereQuery.push(a),this},geoWithinGeometry:function(e,r){var a=t("$geoWithin","$geometry",e,r);return this.whereQuery.push(a),this},geoWithinCenterSphere:function(e,t){var a=[e,t],i=r("$centerSphere",a);return this.whereQuery.push(i),this},exec:function(t){for(var r=0;r<this.whereQuery.length;r++){var a=JSON.stringify(this.whereQuery[r]);a=a.substring(1,a.length-1),0===r?this.executable+=a:this.executable+=","+a}switch(this.model){case"object":this.model="cobject";break;default:this.instance="users"}var i="/api/"+this.model+"/"+e.Stamplay.VERSION+"/"+this.instance+"?where={"+this.executable+"}"+this.paginationQuery+this.selectionQuery+this.sortQuery+this.populateQuery+this.populateOwnerQuery;return e.Stamplay.makeAPromise({method:"GET",url:i},t)}}}e.Stamplay.Query=a}(this),function(e){"use strict";var t={brickId:"user",resourceId:"users",currentUser:function(t){return e.Stamplay.makeAPromise({method:"GET",url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/getStatus"},t)},login:function(t,r){return e.Stamplay.makeAPromise({method:"POST",data:t,url:"/auth/"+e.Stamplay.VERSION+"/local/login"},r)},socialLogin:function(t){if(!t)throw new Error("Stamplay.User.socialLogin needs the service name");var r="/auth/"+e.Stamplay.VERSION+"/"+t+"/connect";if(e.Stamplay.OPTIONS.isMobile){var a=e.open(e.Stamplay.BASEURL+r,"socialLogin","left=1,top=1,width=600,height=600");a.addEventListener("loadstart",function(t){var r=new RegExp("jwt=([A-Za-z0-9-_=]+.[A-Za-z0-9-_=]+.[A-Za-z0-9-_.+=]+)");if(t.url.indexOf("jwt=")>-1){var i=t.url.match(r)[1];store.set(e.location.origin+"-jwt",i),e.Stamplay.OPTIONS.autoRefreshSocialLogin&&location.reload(),a.close()}})}else{var i=store.get(e.location.origin+"-jwt");if(i){var n=new Date;n.setTime(n.getTime()+3e5),e.document.cookie="stamplay.jwt="+i+"; expires="+n.toGMTString()+"; path=/"}var s=e.location.port?":"+e.location.port:"",o=location.protocol+"//"+e.document.domain+s+r;e.Stamplay.OPTIONS.absoluteUrl&&(o=e.Stamplay.BASEURL+r),e.Stamplay.Support.redirect(o)}},signup:function(t,r){return e.Stamplay.makeAPromise({method:"POST",data:t,url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/"+this.resourceId},r)},logout:function(t,r){var a=store.get(e.location.origin+"-jwt");if(e.Stamplay.USESTORAGE&&store.remove(e.location.origin+"-jwt"),t)return e.Stamplay.makeAPromise({method:"GET",url:"/auth/"+e.Stamplay.VERSION+"/logout?jwt="+a},r);var i="/auth/"+e.Stamplay.VERSION+"/logout?jwt="+a,n=e.location.port?":"+e.location.port:"",s=location.protocol+"//"+e.document.domain+n+i;e.Stamplay.OPTIONS.absoluteUrl&&(s=e.Stamplay.BASEURL+i),e.Stamplay.Support.redirect(s)},resetPassword:function(t,r){return e.Stamplay.makeAPromise({method:"POST",data:t,url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/users/resetpassword"},r)},activities:function(t,r){return e.Stamplay.makeAPromise({method:"GET",url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/users/"+t+"/activities"},r)},following:function(t,r){return e.Stamplay.makeAPromise({method:"GET",url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/users/"+t+"/following"},r)},followedBy:function(t,r){return e.Stamplay.makeAPromise({method:"GET",url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/users/"+t+"/followed_by"},r)},follow:function(t,r){return e.Stamplay.makeAPromise({method:"PUT",data:{userId:t},url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/users/follow"},r)},unfollow:function(t,r){return e.Stamplay.makeAPromise({method:"PUT",data:{userId:t},url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/users/unfollow"},r)},getRoles:function(t){return e.Stamplay.makeAPromise({method:"GET",url:"/api/user/"+e.Stamplay.VERSION+"/roles"},t)},getRole:function(t,r){return e.Stamplay.makeAPromise({method:"GET",url:"/api/user/"+e.Stamplay.VERSION+"/roles/"+t},r)},setRole:function(t,r,a){return e.Stamplay.makeAPromise({method:"PATCH",data:{givenRole:r},url:"/api/user/"+e.Stamplay.VERSION+"/users/"+t+"/role"},a)}};e.Stamplay.extend(t,e.Stamplay.BaseComponent(t.brickId,t.resourceId)),delete t.patch,t.remove=function(t,r){return e.Stamplay.makeAPromise({method:"DELETE",url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/"+this.resourceId+"/"+t},r).then(function(t){if(e.Stamplay.USESTORAGE){var r=store.get(e.location.origin+"-jwt");r&&store.remove(e.location.origin+"-jwt")}})},e.Stamplay.User=t}(this),function(e){"use strict";function t(t){if(t)return e.Stamplay.extend({brickId:"cobject",resourceId:t,findByCurrentUser:function(t,r){return 1==arguments.length&&e.Stamplay.isFunction(arguments[0])||0==arguments.length?e.Stamplay.makeAPromise({method:"GET",url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/"+this.resourceId+"/find/owner"},arguments[0]):e.Stamplay.makeAPromise({method:"GET",url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/"+this.resourceId+"/find/"+t},r)},upVote:function(e,t){return r.call(this,e,"vote",{type:"upvote"},t)},downVote:function(e,t){return r.call(this,e,"vote",{type:"downvote"},t)},rate:function(e,t,a){return r.call(this,e,"rate",{rate:t},a)},comment:function(e,t,a){return r.call(this,e,"comment",{text:t},a)},push:function(e,r,s,o){return o?a(t,e).then(function(a){var u=n(a,r,s);return i(t,e,u,o)},function(e){o(e,null)}).fail(function(e){o(e,null)}):a(t,e).then(function(a){var o=n(a,r,s);return i(t,e,o)})}},e.Stamplay.BaseComponent("cobject",t));throw new Error("Stamplay.Object(objecId) needs a objectId")}var r=function(t,r,a,i){return e.Stamplay.makeAPromise({method:"PUT",data:a?a:{},url:"/api/"+this.brickId+"/"+e.Stamplay.VERSION+"/"+this.resourceId+"/"+t+"/"+r},i)},a=function(t,r){return e.Stamplay.BaseComponent("cobject",t+"/"+r).get()},i=function(t,r,a,i){return e.Stamplay.BaseComponent("cobject",t).patch(r,a,i)},n=function(e,t,r){var a={};return a[t]=e[t],a[t].push(r),a};e.Stamplay.Object=t}(this),function(e){"use strict";function t(t){var r=t.replace(/[^\w\s]/gi,"").trim().toLowerCase().replace(/\s+/g,"_"),a="/api/webhook/"+e.Stamplay.VERSION+"/"+r+"/catch";return{post:function(t,r){return e.Stamplay.makeAPromise({method:"POST",data:t,url:a},r)}}}e.Stamplay.Webhook=t}(this),function(e){"use strict";var t={url:"/api/stripe/"+e.Stamplay.VERSION+"/",createCustomer:function(t,r){return e.Stamplay.makeAPromise({method:"POST",data:{userId:t},url:this.url+"customers"},r)},createCreditCard:function(t,r,a){if(arguments.length>=2&&e.Stamplay.isString(arguments[0])&&e.Stamplay.isString(arguments[1]))return e.Stamplay.makeAPromise({method:"POST",data:{token:r},url:this.url+"customers/"+t+"/cards"},a);throw new Error("Stamplay.Stripe.createCustomer:  missing parameters")},updateCreditCard:function(t,r,a){if(arguments.length>=2&&e.Stamplay.isString(arguments[0])&&e.Stamplay.isString(arguments[1]))return e.Stamplay.makeAPromise({method:"PUT",data:{token:r},url:this.url+"customers/"+t+"/cards"},a);throw new Error("Stamplay.Stripe.updateCreditCard:  missing parameters")},charge:function(t,r,a,i,n){if(arguments.length>=4&&e.Stamplay.isString(arguments[0])&&e.Stamplay.isString(arguments[1])&&e.Stamplay.isNumber(arguments[2])&&e.Stamplay.isString(arguments[3]))return e.Stamplay.makeAPromise({method:"POST",data:{userId:t,token:r,amount:a,currency:i},url:this.url+"charges"},n);throw new Error("Stamplay.Stripe.charge:  missing or incorrect parameters")},createSubscription:function(t,r,a){if(arguments.length>=2&&e.Stamplay.isString(arguments[0])&&e.Stamplay.isString(arguments[1]))return e.Stamplay.makeAPromise({method:"POST",data:{planId:r},url:this.url+"customers/"+t+"/subscriptions"},a);throw new Error("Stamplay.Stripe.createSubscription:  missing parameters")},getSubscriptions:function(t,r,a){if(arguments.length>=2)return e.Stamplay.makeAPromise({method:"GET",url:this.url+"customers/"+t+"/subscriptions",thisParams:r},a);throw new Error("Stamplay.Stripe.getSubscriptions:  missing parameters")},getSubscription:function(t,r,a){if(arguments.length>=2&&e.Stamplay.isString(arguments[0])&&e.Stamplay.isString(arguments[1]))return e.Stamplay.makeAPromise({method:"GET",url:this.url+"customers/"+t+"/subscriptions/"+r},a);throw new Error("Stamplay.Stripe.getSubscription:  missing parameters")},getCreditCard:function(t,r){return e.Stamplay.makeAPromise({method:"GET",url:this.url+"customers/"+t+"/cards"},r)},deleteSubscription:function(t,r,a,i){if(arguments.length>=3)return e.Stamplay.makeAPromise({method:"DELETE",url:this.url+"customers/"+t+"/subscriptions/"+r,data:a},i);throw new Error("Stamplay.Stripe.deleteSubscription:  missing parameters")},updateSubscription:function(t,r,a,i){if(arguments.length>=3)return e.Stamplay.makeAPromise({method:"PUT",url:this.url+"customers/"+t+"/subscriptions/"+r,data:{options:a}},i);throw new Error("Stamplay.Stripe.updateSubscription:  missing parameters")}};e.Stamplay.Stripe=t}(this),function(e){"use strict";function t(e){var t="POST";if("string"==typeof e)switch(e){case"GET":case"POST":case"PUT":case"PATCH":case"DELETE":t=e;break;default:throw new Error("Stamplay.codeblock(): Invalid HTTP verb: available verbs are GET,POST,PUT,PATCH and DELETE")}return t}function r(e,t){var r=null==t||void 0==t?void 0:t;switch(e){case"POST":case"PUT":case"PATCH":break;default:r=void 0}return r}function a(a){var i=a.replace(/[^\w\s]/gi,"").trim().toLowerCase().replace(/\s+/g,"_"),n="/api/codeblock/"+e.Stamplay.VERSION+"/run/"+i;return{run:function(a,i,s){var o=t("POST"),u=r("POST",a);return e.Stamplay.makeAPromise({method:o,data:u,url:n,thisParams:i},s)}}}e.Stamplay.Codeblock=a}(this)}])});
//# sourceMappingURL=js-data-stamplay.min.map